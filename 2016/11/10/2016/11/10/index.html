<!DOCTYPE html>
<html lang="en">

<!-- Head tag -->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="61616161616">
    <meta name="keyword" content="null">
    <meta name="theme-color" content="#600090">
    <meta name="msapplication-navbutton-color" content="#600090">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="#600090">
    <link rel="shortcut icon" href="//raw.githubusercontent.com/Yan-1-20/blogimage/52b4712ca778cb89f14783abdb64f6403c45dfce/2.jpg">
    <link rel="alternate" type="application/atom+xml" title="Yan_1_20" href="/atom.xml">
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.css">
    <title>
        
        C#实现SHA-256--光棍节前的代码｜Yan_1_20 blog
        
    </title>

    <link rel="canonical" href="http://yan-1-20.github.io/2016/11/10/2016/11/10/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/blog-style.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">
</head>

<style>

    header.intro-header {
        background-image: url('//github.com/Yan-1-20/blogimage/blob/master/18.jpg?raw=true')
    }
</style>
<!-- hack iOS CSS :active style -->
<body ontouchstart="" class="animated fadeIn">
<!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top " id="nav-top" data-ispost = "true" data-istags="false
" data-ishome = "false" >
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand animated pulse" href="/">
                <span class="brand-logo">
                    Yan_1_20
                </span>
                's Blog
            </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <!-- /.navbar-collapse -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>

                    
                        
                        <li>
                            <a href="/about/">about</a>
                        </li>
                        
                    
                        
                        <li>
                            <a href="/tags/">tags</a>
                        </li>
                        
                    

                </ul>
            </div>
        </div>
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
//    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>

<!-- Main Content -->

<!--only post-->


<img class="wechat-title-img"
     src="//raw.githubusercontent.com/Yan-1-20/blogimage/52b4712ca778cb89f14783abdb64f6403c45dfce/4.jpg">


<style>
    
    header.intro-header {
        background-image: url('//raw.githubusercontent.com/Yan-1-20/blogimage/52b4712ca778cb89f14783abdb64f6403c45dfce/4.jpg')
    }

    
</style>

<header class="intro-header">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <div class="post-heading">
                    <h1>C#实现SHA-256--光棍节前的代码</h1>
                    
                    <span class="meta">
                         作者 Yan_1_20
                        <span>
                          日期 2016/11/10
                         </span>
                    </span>
                    <div class="tags text-center">
                        
                        <a class="tag" href="/tags/#Program"
                           title="Program">Program</a>
                        
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="post-title-haojen">
        <span>
            C#实现SHA-256--光棍节前的代码
        </span>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Container -->
            <div class="col-lg-8 col-lg-offset-1 col-sm-9 post-container">
                <h1 id="0x01莫名其妙的学校作业"><a href="#0x01莫名其妙的学校作业" class="headerlink" title="0x01莫名其妙的学校作业"></a>0x01莫名其妙的学校作业</h1><p>　　　　这个代码，并不是本人想写的，是的，莫名其妙的作业，类似于小毕业设计的东西。。。。代码写完还有3000字的报告。。。。。。莫名奇妙。</p>
<h1 id="0x02代码实现"><a href="#0x02代码实现" class="headerlink" title="0x02代码实现"></a>0x02代码实现</h1><p>　　　　这个加密算法，我当时想的简单，不就是SHA-256嘛，网上代码肯定一大堆，我随便一搜一份就行，悲伤那么大，网上的全身调用库函数实现的，唯一一篇可以参考的c语言实现的，莫名的他下标访问越界的不是一点半点，直接用负数索引元素。但是除去访问越界。他的代码是炒鸡牛逼的，50行就实现了整个SHA-256，代码风格及其牛逼（很难读懂）。</p>
<h1 id="0x03自食其力"><a href="#0x03自食其力" class="headerlink" title="0x03自食其力"></a>0x03自食其力</h1><p>　　　　没办法，找不到代码参考就只能自己写咯，参考密码学标准FIPS180-2</p>
<blockquote>
<p><a href="http://wenku.baidu.com/link?url=1VofDnehD0jIFObdvK3wWHklkUVg_hOsOjAurVQjUViee8uHRYknwu70gqD0zQ7I8umfZ6B-4Z5rj-0BTw89CpIo5tB9_fq3Xe6aUmk7bVm" target="_blank" rel="external">http://wenku.baidu.com/link?url=1VofDnehD0jIFObdvK3wWHklkUVg_hOsOjAurVQjUViee8uHRYknwu70gqD0zQ7I8umfZ6B-4Z5rj-0BTw89CpIo5tB9_fq3Xe6aUmk7bVm</a></p>
</blockquote>
<p>　　　　下面上代码,一个main,一个类，代码并不简洁，并不规范，（可读性比较高）以后想参考的学弟学妹们有福。大牛就不要嫌弃了</p>
<p>　　　加密类的实现<br><figure class="highlight java"><table><tr><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line">using System.Threading.Tasks;</div><div class="line"></div><div class="line">namespace SHA_256</div><div class="line">&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">encode</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">private</span> uint A, B, C, D, E, F, G, H,T1, T2;</div><div class="line">        <span class="keyword">private</span> uint[] K = <span class="keyword">new</span> uint[<span class="number">64</span>] &#123;</div><div class="line">        <span class="number">0x428a2f98</span>, <span class="number">0x71374491</span>, <span class="number">0xb5c0fbcf</span>, <span class="number">0xe9b5dba5</span>, <span class="number">0x3956c25b</span>, <span class="number">0x59f111f1</span>, <span class="number">0x923f82a4</span>, <span class="number">0xab1c5ed5</span>,</div><div class="line">        <span class="number">0xd807aa98</span>, <span class="number">0x12835b01</span>, <span class="number">0x243185be</span>, <span class="number">0x550c7dc3</span>, <span class="number">0x72be5d74</span>, <span class="number">0x80deb1fe</span>, <span class="number">0x9bdc06a7</span>, <span class="number">0xc19bf174</span>,</div><div class="line">        <span class="number">0xe49b69c1</span>, <span class="number">0xefbe4786</span>, <span class="number">0x0fc19dc6</span>, <span class="number">0x240ca1cc</span>, <span class="number">0x2de92c6f</span>, <span class="number">0x4a7484aa</span>, <span class="number">0x5cb0a9dc</span>, <span class="number">0x76f988da</span>,</div><div class="line">        <span class="number">0x983e5152</span>, <span class="number">0xa831c66d</span>, <span class="number">0xb00327c8</span>, <span class="number">0xbf597fc7</span>, <span class="number">0xc6e00bf3</span>, <span class="number">0xd5a79147</span>, <span class="number">0x06ca6351</span>, <span class="number">0x14292967</span>,</div><div class="line">        <span class="number">0x27b70a85</span>, <span class="number">0x2e1b2138</span>, <span class="number">0x4d2c6dfc</span>, <span class="number">0x53380d13</span>, <span class="number">0x650a7354</span>, <span class="number">0x766a0abb</span>, <span class="number">0x81c2c92e</span>, <span class="number">0x92722c85</span>,</div><div class="line">        <span class="number">0xa2bfe8a1</span>, <span class="number">0xa81a664b</span>, <span class="number">0xc24b8b70</span>, <span class="number">0xc76c51a3</span>, <span class="number">0xd192e819</span>, <span class="number">0xd6990624</span>, <span class="number">0xf40e3585</span>, <span class="number">0x106aa070</span>,</div><div class="line">        <span class="number">0x19a4c116</span>, <span class="number">0x1e376c08</span>, <span class="number">0x2748774c</span>, <span class="number">0x34b0bcb5</span>, <span class="number">0x391c0cb3</span>, <span class="number">0x4ed8aa4a</span>, <span class="number">0x5b9cca4f</span>, <span class="number">0x682e6ff3</span>,</div><div class="line">        <span class="number">0x748f82ee</span>, <span class="number">0x78a5636f</span>, <span class="number">0x84c87814</span>, <span class="number">0x8cc70208</span>, <span class="number">0x90befffa</span>, <span class="number">0xa4506ceb</span>, <span class="number">0xbef9a3f7</span>, <span class="number">0xc67178f2</span>,</div><div class="line">         &#125;;</div><div class="line"></div><div class="line">        uint H0 = <span class="number">0x6a09e667</span>u, H1 = <span class="number">0xbb67ae85</span>u, H2 = <span class="number">0x3c6ef372</span>u, H3 = <span class="number">0xa54ff53a</span>u;</div><div class="line">        uint H4 = <span class="number">0x510e527f</span>u, H5 = <span class="number">0x9b05688c</span>u, H6 = <span class="number">0x1f83d9ab</span>u, H7 = <span class="number">0x5be0cd19</span>u;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_ROTL</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123; <span class="keyword">return</span> (((a &gt;&gt; (<span class="number">32</span> - b)) &amp; (<span class="number">0x7fffffff</span> &gt;&gt; (<span class="number">31</span> - b))) | (a &lt;&lt; b)); &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_SR</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span> </span>&#123; <span class="keyword">return</span> ((a &gt;&gt; b) &amp; (<span class="number">0x7fffffff</span> &gt;&gt; (b - <span class="number">1</span>)));  &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_Ch</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> z)</span> </span>&#123; <span class="keyword">return</span> ((x&amp;y)^((~x)&amp;z));  &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_Maj</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y,<span class="keyword">int</span> z)</span> </span>&#123; <span class="keyword">return</span> ((x&amp;y)^(x&amp;z)^(y&amp;z));  &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_E0</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (SHA256_ROTL(x, <span class="number">30</span>) ^ SHA256_ROTL(x, <span class="number">19</span>) ^ SHA256_ROTL(x, <span class="number">10</span>)); &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_E1</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (SHA256_ROTL(x, <span class="number">26</span>) ^ SHA256_ROTL(x, <span class="number">21</span>) ^ SHA256_ROTL(x, <span class="number">7</span>));  &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_O0</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (SHA256_ROTL(x, <span class="number">25</span>) ^ SHA256_ROTL(x, <span class="number">14</span>) ^ SHA256_SR(x, <span class="number">3</span>));  &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">SHA256_O1</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123; <span class="keyword">return</span> (SHA256_ROTL(x, <span class="number">15</span>) ^ SHA256_ROTL(x, <span class="number">13</span>) ^ SHA256_SR(x, <span class="number">10</span>));      &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">FillDate</span><span class="params">(<span class="keyword">byte</span>[] input, <span class="keyword">int</span> datelength, <span class="keyword">byte</span>[] output,<span class="keyword">int</span> encodenumber)</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> zerobit = (<span class="number">448</span> - (datelength * <span class="number">8</span> + <span class="number">1</span>) % <span class="number">512</span>) - <span class="number">7</span>;</div><div class="line">            <span class="keyword">int</span> i,datelengthbitnumber= datelength * <span class="number">8</span>;</div><div class="line">                <span class="keyword">if</span> (zerobit &lt; <span class="number">0</span>)</div><div class="line">                    zerobit = <span class="number">512</span> + zerobit;</div><div class="line">                <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; datelength; i++)</div><div class="line">                &#123;</div><div class="line">                    output[i] = input[i];</div><div class="line">                &#125;</div><div class="line">                output[i++] = (<span class="keyword">byte</span>)<span class="number">128</span>;</div><div class="line">                <span class="keyword">int</span> tmpi = i;</div><div class="line">                <span class="keyword">for</span> (; i &lt; zerobit / <span class="number">8</span>; i++)</div><div class="line">                    output[i] = (<span class="keyword">byte</span>)<span class="number">0</span>;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; ; k++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">if</span> (datelengthbitnumber == <span class="number">0</span>)</div><div class="line">                    <span class="keyword">break</span>;</div><div class="line">                output[<span class="number">63</span> + <span class="number">64</span> * encodenumber-k] =(<span class="keyword">byte</span>) (datelengthbitnumber &amp; <span class="number">0xFF</span>);</div><div class="line">                datelengthbitnumber &gt;&gt;= <span class="number">8</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">GetMbyte</span><span class="params">(<span class="keyword">byte</span>[] resource,<span class="keyword">byte</span>[] M,<span class="keyword">int</span> number,<span class="keyword">int</span> i)</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">64</span>; j++)</div><div class="line">                M[j] = resource[j+i*<span class="number">64</span>];</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Getmint</span><span class="params">(<span class="keyword">byte</span>[] resource, uint[] M, <span class="keyword">int</span> number)</span></span></div><div class="line">        &#123;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</div><div class="line">                &#123;</div><div class="line">                    M[ j] = (uint)(resource[ j * <span class="number">4</span>]&lt;&lt;<span class="number">24</span> | resource[j * <span class="number">4</span>+<span class="number">1</span>] &lt;&lt; <span class="number">16</span> |resource[  j * <span class="number">4</span>+<span class="number">2</span>] &lt;&lt; <span class="number">8</span> | resource[ j * <span class="number">4</span>+<span class="number">3</span>]);</div><div class="line">                &#125;</div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialW</span><span class="params">(uint[] resource, uint[] M, <span class="keyword">int</span> number)</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">int</span> j;</div><div class="line">                <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)</div><div class="line">                &#123;</div><div class="line">                    M[ j] = resource[j];</div><div class="line"></div><div class="line">                &#125;</div><div class="line">                <span class="keyword">for</span> (; j &lt; <span class="number">64</span>; j++)</div><div class="line">                &#123;</div><div class="line">                    <span class="keyword">int</span> a = SHA256_O1((<span class="keyword">int</span>)M[j - <span class="number">2</span>]);</div><div class="line">                    <span class="keyword">int</span> c = (<span class="keyword">int</span>)M[ j - <span class="number">7</span>];</div><div class="line">                    <span class="keyword">int</span> b = SHA256_O0((<span class="keyword">int</span>)M[ j - <span class="number">15</span>]);</div><div class="line">                    <span class="keyword">int</span> d = (<span class="keyword">int</span>)M[ j - <span class="number">16</span>];</div><div class="line">                    M[ j] =(uint)( SHA256_O1((<span class="keyword">int</span>)M[ j - <span class="number">2</span>]) + M[ j - <span class="number">7</span>] + SHA256_O0((<span class="keyword">int</span>)M[j - <span class="number">15</span>]) + M[j-<span class="number">16</span>]);</div><div class="line">                &#125;</div><div class="line">            printW(M);</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">initialregister</span><span class="params">()</span></span></div><div class="line">        &#123;</div><div class="line">            A = H0; B = H1; C = H2; D = H3; E = H4; F = H5; G = H6; H = H7;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">static</span> bool <span class="title">IntToByteArray</span><span class="params">(uint m,  <span class="keyword">byte</span>[] arry)</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">if</span> (arry == <span class="keyword">null</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">            <span class="keyword">if</span> (arry.Length &lt; <span class="number">4</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line"></div><div class="line">            arry[<span class="number">0</span>] = (<span class="keyword">byte</span>)(m &amp; <span class="number">0xFF</span>);</div><div class="line">            arry[<span class="number">1</span>] = (<span class="keyword">byte</span>)((m &amp; <span class="number">0xFF00</span>) &gt;&gt; <span class="number">8</span>);</div><div class="line">            arry[<span class="number">2</span>] = (<span class="keyword">byte</span>)((m &amp; <span class="number">0xFF0000</span>) &gt;&gt; <span class="number">16</span>);</div><div class="line">            arry[<span class="number">3</span>] = (<span class="keyword">byte</span>)((m &gt;&gt; <span class="number">24</span>) &amp; <span class="number">0xFF</span>);</div><div class="line"></div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">endcode</span><span class="params">(uint[] M,<span class="keyword">int</span> number)</span></span></div><div class="line">        &#123;</div><div class="line"></div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</div><div class="line">                &#123;</div><div class="line">                    T1 =(uint) (H + SHA256_E1((<span class="keyword">int</span>)E) + SHA256_Ch((<span class="keyword">int</span>)E, (<span class="keyword">int</span>)F, (<span class="keyword">int</span>)G) + K[i] + M[i]);</div><div class="line">                    T2 = (uint)(SHA256_E0((<span class="keyword">int</span>)A) + SHA256_Maj((<span class="keyword">int</span>)A, (<span class="keyword">int</span>)B, (<span class="keyword">int</span>)C));</div><div class="line">                    H = G; G = F; F = E; E = D + T1; D = C; C = B; B = A; A = T1 + T2;</div><div class="line">                    Console.WriteLine(<span class="string">"t=&#123;0&#125; A:&#123;1&#125;  B:&#123;2&#125;  C:&#123;3&#125; D:&#123;4&#125; E:&#123;5&#125; F:&#123;6&#125; G:&#123;7&#125; H:&#123;8&#125;"</span>,i.ToString(), addZero(A), addZero(B),addZero(C), addZero(D),</div><div class="line">                &#125;</div><div class="line">                H0 += A; H1 += B; H2 += C; H3 += D; H4 += E; H5 += F; H6 += G; H7 += H;</div><div class="line">                Console.WriteLine(<span class="string">"\n\n"</span>);</div><div class="line">                Console.WriteLine(<span class="string">"T H0:&#123;0&#125;  H1:&#123;1&#125;  H2:&#123;2&#125; H3:&#123;3&#125; H4:&#123;4&#125; H5:&#123;5&#125; H6:&#123;6&#125; H7:&#123;7&#125;"</span>,</div><div class="line">                addZero(H0), addZero(H1), addZero(H2), addZero(H3), addZero(H4), addZero(H5), addZero(H6), addZero(H7));</div><div class="line">                Console.WriteLine(<span class="string">"\n\n"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">changHsbit</span><span class="params">()</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">byte</span>[] tmp = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">4</span>];</div><div class="line">            IntToByteArray(H0,tmp);</div><div class="line">            H0 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H1, tmp);</div><div class="line">            H1 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H2, tmp);</div><div class="line">            H2 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H3, tmp);</div><div class="line">            H3 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H4, tmp);</div><div class="line">            H4 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H5, tmp);</div><div class="line">            H5 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H6, tmp);</div><div class="line">            H6 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">            IntToByteArray(H7, tmp);</div><div class="line">            H7 = (uint)(tmp[<span class="number">3</span>] &lt;&lt; <span class="number">24</span> | tmp[<span class="number">2</span>] &lt;&lt; <span class="number">16</span> | tmp[<span class="number">1</span>] &lt;&lt; <span class="number">8</span> | tmp[<span class="number">0</span>]);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> string <span class="title">addZero</span><span class="params">(uint W)</span></span></div><div class="line">        &#123;</div><div class="line">            string tmp1 = <span class="string">""</span>, tmp2;</div><div class="line">            <span class="keyword">int</span> len;</div><div class="line">            <span class="keyword">if</span> (W &lt; <span class="number">0x10000000</span>)</div><div class="line">            &#123;</div><div class="line">                tmp2 = W.ToString(<span class="string">"x"</span>);</div><div class="line">                len = tmp2.Length;</div><div class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">8</span> - len; j++)</div><div class="line">                    tmp1 += <span class="string">'0'</span>;</div><div class="line">                tmp1 += W.ToString(<span class="string">"x"</span>);</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">else</span></div><div class="line">                <span class="keyword">return</span> W.ToString(<span class="string">"x"</span>);</div><div class="line">            <span class="keyword">return</span> tmp1;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printW</span><span class="params">(uint [] W)</span></span></div><div class="line">        &#123;</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">64</span>; i++)</div><div class="line">            &#123;</div><div class="line"></div><div class="line">                    Console.WriteLine(<span class="string">" W[&#123;0&#125;]:   0x&#123;1&#125;"</span>, i.ToString(), addZero(W[i]));</div><div class="line"></div><div class="line">            &#125;</div><div class="line">            Console.WriteLine(<span class="string">"\n\n"</span>);</div><div class="line">        &#125;</div><div class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">printencode</span><span class="params">()</span></span></div><div class="line">        &#123;</div><div class="line">            changHsbit();</div><div class="line">            Console.WriteLine(<span class="string">"SHA-256 encode: &#123;0&#125;  &#123;1&#125;  &#123;2&#125; &#123;3&#125; &#123;4&#125; &#123;5&#125; &#123;6&#125; &#123;7&#125;"</span>,</div><div class="line">                addZero(H0), addZero(H1), addZero(H2), addZero(H3), addZero(H4), addZero(H5), addZero(H6), addZero(H7));</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div></pre></td></tr></table></figure></p>
<p>　　　主函数 调用</p>
<figure class="highlight java"><table><tr><td class="code"><pre><div class="line">using System;</div><div class="line">using System.Collections.Generic;</div><div class="line">using System.Linq;</div><div class="line">using System.Text;</div><div class="line">using System.Threading.Tasks;</div><div class="line">using System.Text;</div><div class="line">using SHA_256;</div><div class="line"></div><div class="line">namespace SHA_256</div><div class="line">&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Program</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span><span class="params">(string[] args)</span></span></div><div class="line">        &#123;</div><div class="line">            Encoding enc = <span class="keyword">new</span> UTF8Encoding(<span class="keyword">true</span>, <span class="keyword">true</span>);</div><div class="line">            <span class="comment">//C#默认unicode编码，上面的类可以把其转换为多字节编码</span></div><div class="line">            encode MYSHA = <span class="keyword">new</span> encode();</div><div class="line">            Console.WriteLine(<span class="string">"input you data encode sha-256:"</span>);</div><div class="line">            string str = Console.ReadLine();</div><div class="line">            <span class="keyword">byte</span>[] bte = enc.GetBytes(str);</div><div class="line">            <span class="keyword">int</span> encodedatelength = bte.Length;</div><div class="line">            <span class="keyword">int</span> encodenumber = <span class="number">0</span>;</div><div class="line">            <span class="keyword">byte</span>[] MM;</div><div class="line">            <span class="keyword">if</span> (encodedatelength &gt;= <span class="number">56</span>)</div><div class="line">            &#123;</div><div class="line">                encodenumber = encodedatelength / <span class="number">56</span>;</div><div class="line">            &#125;</div><div class="line">            MM = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">64</span> * (encodenumber + <span class="number">1</span>)];</div><div class="line">            MYSHA.FillDate(bte, encodedatelength, MM, encodenumber);  <span class="comment">// ok</span></div><div class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; encodenumber + <span class="number">1</span>; i++)</div><div class="line">            &#123;</div><div class="line">                <span class="keyword">byte</span>[] M = <span class="keyword">new</span> <span class="keyword">byte</span>[<span class="number">64</span>];</div><div class="line">                MYSHA.GetMbyte(MM, M, encodenumber + <span class="number">1</span>,i);   <span class="comment">//ok</span></div><div class="line">                uint[] m = <span class="keyword">new</span> uint[<span class="number">16</span>];</div><div class="line">                MYSHA.Getmint(M, m, encodenumber + <span class="number">1</span>);    <span class="comment">//ok</span></div><div class="line">                uint[] W = <span class="keyword">new</span> uint[<span class="number">64</span>];</div><div class="line">                MYSHA.initialW(m, W, encodenumber + <span class="number">1</span>);</div><div class="line">                MYSHA.initialregister();</div><div class="line">                MYSHA.endcode(W, encodenumber + <span class="number">1</span>);</div><div class="line">            &#125;</div><div class="line">          MYSHA.printencode();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>。。。。</p>

                <hr>
                

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/11/13/2016/11/13/" data-toggle="tooltip" data-placement="top"
                           title="CVE-2012-003">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/10/31/2016/10/31/" data-toggle="tooltip" data-placement="top"
                           title="10月->月末总结">Next Post &rarr;</a>
                    </li>
                    
                </ul>

                

                

            </div>

            <div class="hidden-xs col-sm-3 toc-col">
                <div class="toc-wrap">
                    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#0x01莫名其妙的学校作业"><span class="toc-text">0x01莫名其妙的学校作业</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x02代码实现"><span class="toc-text">0x02代码实现</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#0x03自食其力"><span class="toc-text">0x03自食其力</span></a></li></ol>
                </div>
            </div>
        </div>

        <div class="row">
            <!-- Sidebar Container -->

            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <!-- no hr -->
                    <h5 class="text-center">
                        <a href="/tags/">FEATURED TAGS</a>
                    </h5>
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#Program"
                           title="Program">Program</a>
                        
                    </div>
                </section>
                

                <!-- Friends Blog -->
                
                <div style="margin-top: 20px;">
                    <h5 class="text-center">FRIENDS</h5>
                    <ul class="list-inline text-center">
                        
                        <li><a href="http://over-rainbow.cn">Gay_hxs</a></li>
                        
                        <li><a href="http://a2ir.github.io/">A2ir</a></li>
                        
                    </ul>
                </div>
                
            </div>
        </div>

    </div>
</article>






<!-- Footer -->
<!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1 text-center">
                <br>
                <ul class="list-inline text-center">
                
                
                

                
                    <li>
                        <a target="_blank" href="http://weibo.com/6016118396">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                
                    <li>
                        <a target="_blank"  href="https://github.com/yan-1-20">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                

                

                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Yan_1_20 2017
                    <br>
                    <span id="busuanzi_container_site_pv" style="font-size: 12px;">当前访问量: <span id="busuanzi_value_site_pv"></span> 次</span>
                    <br>
                    Theme by <a href="https://yan-1-20.github.io/">Yan_1_20</a>
                </p>

            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="/js/blog.js"></script>

<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("http://yan-1-20.github.io/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("//cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>

<!-- Google Analytics -->



<!-- Baidu Tongji -->

<script>
    var _baId = '931bf86e308ff2ebfdee39ebcc954723';
    // Originial
    var _hmt = _hmt || [];
    (function() {
        var hm = document.createElement("script");
        hm.src = "//hm.baidu.com/hm.js?" + _baId;
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(hm, s);
    })();
</script>


<!-- swiftype -->
<script type="text/javascript">
  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

  _st('install','null','2.0.0');
</script>

<script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<!--wechat title img-->
<img class="wechat-title-img" src="//avatars3.githubusercontent.com/u/19972411?v=3&amp;s=466">
</body>

</html>
